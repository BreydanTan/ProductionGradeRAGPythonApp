# ç”Ÿäº§çº§RAG Pythonåº”ç”¨ - å®Œæ•´é¡¹ç›®è§„æ ¼æ–‡æ¡£

**æœ€åŽæ›´æ–°æ—¶é—´**: 2025-11-16
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**é¡¹ç›®åç§°**: Production-Ready RAG Python Application
**ç›®æ ‡å—ä¼—**: æ‰€æœ‰å¼€å‘è€…å’ŒæŠ€æœ¯å†³ç­–è€…

---

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æž¶æž„](#æŠ€æœ¯æž¶æž„)
3. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
4. [æ ¸å¿ƒä¸šåŠ¡æµç¨‹](#æ ¸å¿ƒä¸šåŠ¡æµç¨‹)
5. [APIæŽ¥å£æ–‡æ¡£](#apiæŽ¥å£æ–‡æ¡£)
6. [çŽ¯å¢ƒé…ç½®æŒ‡å—](#çŽ¯å¢ƒé…ç½®æŒ‡å—)
7. [æœ¬åœ°å¼€å‘æŒ‡å—](#æœ¬åœ°å¼€å‘æŒ‡å—)
8. [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
9. [å¸¸è§é—®é¢˜FAQ](#å¸¸è§é—®é¢˜faq)
10. [æœ¯è¯­å¯¹ç…§è¡¨](#æœ¯è¯­å¯¹ç…§è¡¨)

---

## é¡¹ç›®æ¦‚è¿°

### ä¸€å¥è¯æè¿°

è¿™æ˜¯ä¸€ä¸ªè®©ä½ ä¸Šä¼ PDFæ–‡æ¡£ï¼Œç„¶åŽç”¨è‡ªç„¶è¯­è¨€æé—®æ¥èŽ·å–ç­”æ¡ˆçš„AIåº”ç”¨ã€‚å°±åƒæ‹¥æœ‰ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥è¯»æ‡‚ä½ çš„æ‰€æœ‰æ–‡æ¡£ï¼Œå¹¶å¿«é€Ÿå›žç­”å…³äºŽå®ƒä»¬çš„é—®é¢˜ã€‚

### æ ¸å¿ƒåŠŸèƒ½

æƒ³è±¡ä½ æœ‰ä¸€ä¸ªå·¨å¤§çš„å›¾ä¹¦é¦†ã€‚è¿™ä¸ªåº”ç”¨åšçš„äº‹æƒ…æ˜¯ï¼š

1. **ðŸ“„ æŽ¥æ”¶æ–‡æ¡£** - ä½ ä¸Šä¼ PDFæ–‡ä»¶ï¼ˆå°±åƒæŠŠä¹¦æ”¾å…¥å›¾ä¹¦é¦†ï¼‰
2. **ðŸ” ç†è§£å†…å®¹** - AIè¯»å–å¹¶ç†è§£æ–‡æ¡£å†…å®¹ï¼ˆç±»ä¼¼å›¾ä¹¦é¦†å‘˜è®°ä½äº†æ¯æœ¬ä¹¦çš„å…³é”®ä¿¡æ¯ï¼‰
3. **ðŸ’¬ å›žç­”é—®é¢˜** - ä½ ç”¨è‡ªç„¶è¯­è¨€æé—®ï¼ŒAIä»Žæ–‡æ¡£ä¸­æ‰¾å‡ºç›¸å…³å†…å®¹å¹¶å›žç­”

**å®Œæ•´åŠŸèƒ½åˆ—è¡¨**ï¼š

| åŠŸèƒ½ | è¯´æ˜Ž | ç±»æ¯” |
|------|------|------|
| PDFä¸Šä¼ å’Œå¤„ç† | æ”¯æŒä¸Šä¼ PDFæ–‡ä»¶å¹¶è‡ªåŠ¨åˆ†æž | å°†ä¹¦ç±æ·»åŠ åˆ°å›¾ä¹¦é¦† |
| æ™ºèƒ½åˆ†å— | è‡ªåŠ¨å°†é•¿æ–‡æ¡£åˆ†æˆå°å— | åœ¨ä¹¦é¡µä¸Šåšç¬”è®°ä¾¿äºŽæŸ¥æ‰¾ |
| å‘é‡åŒ–å­˜å‚¨ | å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—æ ¼å¼å­˜å‚¨ | åˆ›å»ºå›¾ä¹¦é¦†çš„ç´¢å¼• |
| è¯­ä¹‰æœç´¢ | æ ¹æ®æ„æ€æŸ¥æ‰¾ç›¸å…³å†…å®¹ï¼Œè€Œä¸æ˜¯å…³é”®è¯ | é€šè¿‡æ¦‚å¿µæŸ¥æ‰¾ä¹¦ç±ï¼Œè€Œéžé€å­—æœç´¢ |
| AIé—®ç­” | ä½¿ç”¨ChatGPTç”Ÿæˆç­”æ¡ˆ | è¯·å›¾ä¹¦é¦†å‘˜ç”¨è‡ªå·±çš„è¯è§£é‡ŠæŸä¸ªä¸»é¢˜ |
| ç”Ÿäº§çº§ä¿æŠ¤ | è‡ªåŠ¨é‡è¯•ã€é™æµã€ç›‘æŽ§ | å›¾ä¹¦é¦†çš„å®‰å…¨ç³»ç»Ÿå’Œè®¿é—®æŽ§åˆ¶ |

### æŠ€æœ¯æ ˆç®€ä»‹

```
ç”¨æˆ·ç•Œé¢ (Web)
    â†“
PythonåŽç«¯ (FastAPI)
    â†“
äº‹ä»¶ç³»ç»Ÿ (Inngest)
    â†“
å‘é‡æ•°æ®åº“ (Qdrant)
    â†“
AIæ¨¡åž‹ (OpenAI)
```

---

## æŠ€æœ¯æž¶æž„

### ç³»ç»Ÿæ•´ä½“æž¶æž„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ· / User                                  â”‚
â”‚                  (æµè§ˆå™¨è®¿é—®åº”ç”¨)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Streamlit Webç•Œé¢                              â”‚
â”‚          (streamlit_app.py - å‰ç«¯ç”¨æˆ·ç•Œé¢)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä¸Šéƒ¨åˆ†: PDFä¸Šä¼ åŒºåŸŸ                                     â”‚   â”‚
â”‚  â”‚  â”œâ”€ æ–‡ä»¶é€‰æ‹©å™¨ï¼šé€‰æ‹©PDFæ–‡ä»¶                             â”‚   â”‚
â”‚  â”‚  â””â”€ ä¸Šä¼ æŒ‰é’®ï¼šå¼€å§‹ä¸Šä¼                                  â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  ä¸‹éƒ¨åˆ†: æé—®åŒºåŸŸ                                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ è¾“å…¥æ¡†ï¼šè¾“å…¥ä½ çš„é—®é¢˜                               â”‚   â”‚
â”‚  â”‚  â”œâ”€ æ»‘å—ï¼šé€‰æ‹©è¿”å›žå¤šå°‘ä¸ªç›¸å…³æ®µè½(1-20)                â”‚   â”‚
â”‚  â”‚  â””â”€ æäº¤æŒ‰é’®ï¼šèŽ·å–ç­”æ¡ˆ                                 â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  ç»“æžœæ˜¾ç¤ºåŒºåŸŸ                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€ AIç”Ÿæˆçš„ç­”æ¡ˆ                                       â”‚   â”‚
â”‚  â”‚  â””â”€ æ¥æºæ–‡ä»¶åˆ—è¡¨                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                   â”‚
                   (Inngestäº‹ä»¶ / Events)   â”‚
                        â”‚                   â”‚
                        â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Inngest äº‹ä»¶é©±åŠ¨å¼•æ“Ž                                   â”‚
â”‚     (è‡ªåŠ¨å¤„ç†é™æµã€é‡è¯•ã€ç›‘æŽ§)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ æŽ§åˆ¶å±‚ (Rate Limiting & Throttling) â”‚                          â”‚
â”‚  â”‚ â€¢ æ¯4å°æ—¶æœ€å¤šä¸Šä¼ 1ä¸ªPDF per æ–‡ä»¶å  â”‚                          â”‚
â”‚  â”‚ â€¢ æ¯åˆ†é’Ÿæœ€å¤šå¤„ç†2ä¸ªä¸Šä¼ è¯·æ±‚         â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ äº‹ä»¶è·¯ç”±                            â”‚                          â”‚
â”‚  â”‚ â”œâ”€ rag/ingest_pdf (ä¸Šä¼ å’Œå¤„ç†)    â”‚                          â”‚
â”‚  â”‚ â””â”€ rag/query_pdf_ai (æé—®å’Œå›žç­”)   â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                              â”‚
            â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPIåŽç«¯æ ¸å¿ƒé€»è¾‘     â”‚    â”‚  æœç´¢å¼•æ“Ž                â”‚
â”‚  (main.py)               â”‚    â”‚  (vector_db.py)          â”‚
â”‚                          â”‚    â”‚                          â”‚
â”‚  PDFå¤„ç†æ­¥éª¤:           â”‚    â”‚  æœç´¢ç›¸å…³æ®µè½            â”‚
â”‚  1. è¯»å–PDFæ–‡ä»¶          â”‚    â”‚  1. é—®é¢˜å‘é‡åŒ–           â”‚
â”‚  2. åˆ†å—å¤„ç†(1000å­—ç¬¦)   â”‚    â”‚  2. å‘é‡ç›¸ä¼¼åº¦æŸ¥è¯¢       â”‚
â”‚  3. ç”Ÿæˆå‘é‡åµŒå…¥         â”‚    â”‚  3. è¿”å›žtop_kä¸ªæ®µè½     â”‚
â”‚  4. å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“     â”‚    â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                               â”‚
               â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚            â”‚
               â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Qdrant å‘é‡æ•°æ®åº“                  â”‚
â”‚    (qdrant_storage/)                 â”‚
â”‚                                      â”‚
â”‚  é›†åˆ "docs"                          â”‚
â”‚  â”œâ”€ æ–‡æ¡£æ®µè½å‘é‡ (3072ç»´)             â”‚
â”‚  â”œâ”€ æ®µè½æ–‡æœ¬å†…å®¹                      â”‚
â”‚  â””â”€ æ¥æºæ–‡ä»¶ä¿¡æ¯                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â–²      â”‚
      â”‚      â–¼
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  â”‚ OpenAI API       â”‚
      â”‚  â”‚                  â”‚
      â”‚  â”‚ â€¢ æ–‡æœ¬å‘é‡åŒ–     â”‚
      â”‚  â”‚   (embedding)    â”‚
      â”‚  â”‚                  â”‚
      â”‚  â”‚ â€¢ ChatGPTå›žç­”    â”‚
      â”‚  â”‚   (gpt-4o-mini)  â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â””â”€ ç½‘ç»œè¯·æ±‚
```

### æ¨¡å—åŒ–è¯´æ˜Ž

é¡¹ç›®åŒ…å«5ä¸ªæ ¸å¿ƒPythonæ–‡ä»¶ï¼š

```
ProjectionGradeRAGPythonApp/
â”‚
â”œâ”€â”€ main.py                  # ðŸŸ¡ åŽç«¯æœåŠ¡å™¨ (103è¡Œ)
â”‚   â”œâ”€ FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€ Inngestå‡½æ•°å®šä¹‰
â”‚   â””â”€ é™æµå’ŒèŠ‚æµé…ç½®
â”‚
â”œâ”€â”€ streamlit_app.py         # ðŸŸ¡ å‰ç«¯ç•Œé¢ (127è¡Œ)
â”‚   â”œâ”€ Webç”¨æˆ·ç•Œé¢
â”‚   â”œâ”€ äº‹ä»¶å‘é€é€»è¾‘
â”‚   â””â”€ ç»“æžœå±•ç¤º
â”‚
â”œâ”€â”€ vector_db.py             # ðŸŸ¡ å‘é‡æ•°æ®åº“ (37è¡Œ)
â”‚   â”œâ”€ Qdrantè¿žæŽ¥ç®¡ç†
â”‚   â””â”€ æœç´¢åŠŸèƒ½
â”‚
â”œâ”€â”€ data_loader.py           # ðŸŸ¡ æ•°æ®å¤„ç† (28è¡Œ)
â”‚   â”œâ”€ PDFè¯»å–
â”‚   â”œâ”€ æ–‡æœ¬åˆ†å—
â”‚   â””â”€ å‘é‡ç”Ÿæˆ
â”‚
â””â”€â”€ custom_types.py          # ðŸŸ¡ æ•°æ®æ¨¡åž‹ (21è¡Œ)
    â””â”€ Pydanticæ¨¡åž‹å®šä¹‰
```

### æ•°æ®æµå‘å›¾

#### æµç¨‹1: PDFä¸Šä¼ å’Œå¤„ç†

```
ðŸ‘¤ ç”¨æˆ·é€‰æ‹©PDFæ–‡ä»¶
    â”‚
    â–¼
ðŸ“¤ Streamlitä¸Šä¼ å™¨
    â”‚ ä¿å­˜æ–‡ä»¶åˆ° uploads/
    â”‚
    â–¼
ðŸ“¨ å‘é€ Inngest äº‹ä»¶
    â”‚ Event: "rag/ingest_pdf"
    â”‚
    â–¼
â³ Inngest å¼•æ“Ž
    â”‚ æ£€æŸ¥é™æµ: æ¯æ–‡ä»¶æ¯4å°æ—¶1æ¬¡
    â”‚ æ£€æŸ¥èŠ‚æµ: æ¯åˆ†é’Ÿæœ€å¤š2ä¸ª
    â”‚
    â–¼
ðŸ“– PDFè¯»å– (data_loader.py)
    â”‚ â€¢ ç”¨LlamaIndexè¯»å–PDF
    â”‚ â€¢ ç”¨SentenceSplitteråˆ†å—
    â”‚   - å—å¤§å°: 1000å­—ç¬¦
    â”‚   - é‡å : 200å­—ç¬¦
    â”‚
    â–¼
ðŸ”¢ ç”Ÿæˆå‘é‡ (OpenAI API)
    â”‚ â€¢ æ¨¡åž‹: text-embedding-3-large
    â”‚ â€¢ ç»´åº¦: 3072
    â”‚ â€¢ æ‰¹é‡å¤„ç†: ä¸€æ¬¡æ€§åµŒå…¥æ‰€æœ‰å—
    â”‚
    â–¼
ðŸ’¾ å­˜å‚¨åˆ°Qdrant
    â”‚ â€¢ ç”Ÿæˆå”¯ä¸€ID (UUID)
    â”‚ â€¢ å­˜å‚¨å‘é‡å’ŒåŽŸå§‹æ–‡æœ¬
    â”‚ â€¢ è®°å½•æ¥æºæ–‡ä»¶å
    â”‚
    â–¼
âœ… è¿”å›žæˆåŠŸ
    â”‚ å‘Šè¯‰ç”¨æˆ·ä¸Šä¼ äº†å¤šå°‘æ®µè½
```

#### æµç¨‹2: é—®é¢˜å›žç­”

```
ðŸ’¬ ç”¨æˆ·è¾“å…¥é—®é¢˜
    â”‚
    â–¼
ðŸ“¨ å‘é€ Inngest äº‹ä»¶
    â”‚ Event: "rag/query_pdf_ai"
    â”‚ Data: {question, top_k}
    â”‚
    â–¼
ðŸ” é—®é¢˜å‘é‡åŒ– (OpenAI API)
    â”‚ å°†é—®é¢˜è½¬æ¢ä¸º3072ç»´å‘é‡
    â”‚
    â–¼
ðŸ”Ž Qdrantæœç´¢
    â”‚ â€¢ è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
    â”‚ â€¢ è¿”å›žæœ€ç›¸ä¼¼çš„top_kä¸ªæ®µè½
    â”‚ â€¢ æŒ‰ç›¸ä¼¼åº¦æŽ’åº
    â”‚
    â–¼
ðŸ§  AIç”Ÿæˆç­”æ¡ˆ (GPT-4o-mini)
    â”‚ è¾“å…¥:
    â”‚ â”œâ”€ ç³»ç»Ÿæç¤º: "åªç”¨ç»™å®šçš„æ®µè½å›žç­”"
    â”‚ â”œâ”€ ç›¸å…³æ®µè½ (top_kä¸ª)
    â”‚ â””â”€ ç”¨æˆ·é—®é¢˜
    â”‚
    â–¼
ðŸ’­ è¿”å›žç­”æ¡ˆ
    â”‚ â”œâ”€ AIç”Ÿæˆçš„æ–‡æœ¬
    â”‚ â”œâ”€ æ¥æºæ–‡ä»¶åˆ—è¡¨
    â”‚ â””â”€ ä½¿ç”¨çš„æ®µè½æ•°
```

---

## æ•°æ®åº“è®¾è®¡

### æ•°æ®åº“ç±»åž‹

è¿™ä¸ªé¡¹ç›®ä½¿ç”¨**å‘é‡æ•°æ®åº“**ï¼Œä¸æ˜¯ä¼ ç»Ÿçš„SQLæ•°æ®åº“ã€‚

**ä¸ºä»€ä¹ˆæ˜¯å‘é‡æ•°æ®åº“?**
- ä¼ ç»Ÿæ•°æ®åº“å­˜å‚¨æ•°æ®ï¼Œå‘é‡æ•°æ®åº“å­˜å‚¨"æ•°æ®çš„å«ä¹‰"
- ç±»ä¼¼äºŽå¤§è„‘è®°å¿†ï¼šä¸æ˜¯è®°ä½å­—ï¼Œè€Œæ˜¯è®°ä½æ¦‚å¿µ
- æ”¯æŒ"è¯­ä¹‰æœç´¢"ï¼šæ ¹æ®æ„æ€æ‰¾ç»“æžœï¼Œè€Œéžå…³é”®è¯

### æ•°æ®æ¨¡åž‹

#### ä¸»è¦æ•°æ®ç»“æž„

```
ä¸€ä»½æ–‡æ¡£ (PDF)
    â”‚
    â”œâ”€ è¢«åˆ†å‰²æˆ N ä¸ªæ®µè½
    â”‚
    â””â”€ æ¯ä¸ªæ®µè½åŒ…å«:
        â”œâ”€ ID (å”¯ä¸€æ ‡è¯†)
        â”œâ”€ æ–‡æœ¬å†…å®¹ (1000å­—ç¬¦å·¦å³)
        â”œâ”€ å‘é‡å‘é‡ (3072ä¸ªæ•°å­—)
        â””â”€ æ¥æºæ–‡ä»¶å
```

#### Qdranté›†åˆç»“æž„

```
é›†åˆåç§°: "docs"
â”œâ”€ å‘é‡ç»´åº¦: 3072 (OpenAI text-embedding-3-large)
â”œâ”€ è·ç¦»åº¦é‡: ä½™å¼¦ç›¸ä¼¼åº¦ (Cosine Similarity)
â”‚   â””â”€ èŒƒå›´: 0-2
â”‚      0 = å®Œå…¨ç›¸åŒ
â”‚      2 = å®Œå…¨ä¸åŒ
â”‚
â””â”€ å­˜å‚¨ä½ç½®: qdrant_storage/ (æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ)
```

#### æ•°æ®æ¨¡åž‹ï¼ˆPydanticï¼‰

```python
# è¾“å…¥: PDFå’Œå—ä¿¡æ¯
class RAGChunkAndSrc(BaseModel):
    chunks: list[str]       # æ–‡æœ¬å—åˆ—è¡¨
    source_id: str          # PDFæ–‡ä»¶å

# è¾“å‡º: ä¸Šä¼ ç»“æžœ
class RAGUpsertResult(BaseModel):
    ingested: int           # æˆåŠŸä¸Šä¼ äº†å¤šå°‘å—

# è¾“å‡º: æœç´¢ç»“æžœ
class RAGSearchResult(BaseModel):
    contexts: list[str]     # æ‰¾åˆ°çš„æ–‡æœ¬å—
    sources: list[str]      # æ¥æºæ–‡ä»¶åˆ—è¡¨

# è¾“å‡º: æœ€ç»ˆç­”æ¡ˆ
class RAGQueryResult(BaseModel):
    answer: str             # AIç”Ÿæˆçš„ç­”æ¡ˆ
    sources: list[str]      # æ¥æºæ–‡ä»¶
    num_contexts: int       # ä½¿ç”¨äº†å¤šå°‘ä¸ªå—
```

### æ•°æ®å…³ç³»å›¾

```
PDFæ–‡æ¡£ (uploads/)
    â”‚
    â”œâ”€ æ–‡ä»¶å: "machine_learning.pdf"
    â”œâ”€ å¤§å°: 1.5MB
    â””â”€ ä¸Šä¼ æ—¶é—´: 2025-11-16
        â”‚
        â”‚ (1å¯¹å¤šå…³ç³»)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–‡æœ¬å— (Qdrantä¸­çš„Point)         â”‚
â”‚                                 â”‚
â”‚ ID: uuid5(filename + index)     â”‚
â”‚ æ–‡æœ¬: "æœºå™¨å­¦ä¹ æ˜¯..."            â”‚
â”‚ å‘é‡: [0.123, -0.456, ...]     â”‚
â”‚ æ¥æº: "machine_learning.pdf"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ (å¤šå¯¹å¤šå…³ç³»)
        â”‚
        â–¼
ç”¨æˆ·æŸ¥è¯¢
â”‚ é—®é¢˜: "ä»€ä¹ˆæ˜¯ç›‘ç£å­¦ä¹ ?"
â””â”€ Qdrantè¿”å›žæœ€ç›¸ä¼¼çš„5ä¸ªå—
   - å—1 (ç›¸ä¼¼åº¦0.8)
   - å—2 (ç›¸ä¼¼åº¦0.75)
   - ...
```

### æ•°æ®å®Œæ•´æ€§

**IDç”Ÿæˆç­–ç•¥ï¼ˆç¡®å®šæ€§UUIDï¼‰**:
```
ID = SHA-UUID(æ–‡ä»¶å + å—ç´¢å¼•)
ä¾‹å¦‚: uuid5(filename="ai.pdf", index=0)

ä¼˜ç‚¹:
âœ“ ç›¸åŒæ–‡ä»¶äº§ç”Ÿç›¸åŒID
âœ“ é‡å¤ä¸Šä¼ è‡ªåŠ¨è¦†ç›–
âœ“ é¿å…é‡å¤æ•°æ®

ç¼ºç‚¹:
âœ— ä¸èƒ½åŒæ—¶æœ‰å¤šä¸ªç‰ˆæœ¬
```

**æ²¡æœ‰å¤–é”®çº¦æŸ**:
- å‘é‡æ•°æ®åº“ä¸æ”¯æŒå¤–é”®
- ä¾é payloadä¸­çš„"source"å­—æ®µå…³è”
- åˆ é™¤PDFæ–‡ä»¶åŽï¼Œå‘é‡ä»å­˜åœ¨ï¼ˆéœ€æ‰‹åŠ¨æ¸…ç†ï¼‰

---

## æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### æµç¨‹1: PDFä¸Šä¼ æµç¨‹

```
æ—¶é—´çº¿: ä»Žç”¨æˆ·é€‰æ‹©æ–‡ä»¶åˆ°å®Œæˆä¸Šä¼ 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç”¨æˆ·æ“ä½œå±‚ (Streamlitå‰ç«¯)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤1: ç”¨æˆ·ç‚¹å‡»"Choose a PDF"   â”‚ â† æ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤2: ç”¨æˆ·é€‰æ‹©PDFå¹¶ç¡®è®¤        â”‚ â† æ–‡ä»¶å¯¹è±¡ä¼ å…¥Streamlit
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤3: æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°           â”‚ â† uploads/filename.pdf
â”‚        save_uploaded_pdf()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤4: æ˜¾ç¤ºåŠ è½½åŠ¨ç”»             â”‚ â† with st.spinner(...)
â”‚        å¹¶å‘é€Inngestäº‹ä»¶        â”‚ â† asyncio.run(...)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ (ç½‘ç»œè¯·æ±‚)

äº‹ä»¶å¤„ç†å±‚ (Inngest + FastAPIåŽç«¯)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤5: InngestæŽ¥æ”¶ "rag/ingest_pdf" äº‹ä»¶  â”‚
â”‚        æ£€æŸ¥é™æµè§„åˆ™                        â”‚
â”‚        â€¢ é¢‘çŽ‡: æ¯source_idæ¯4å°æ—¶æœ€å¤š1æ¬¡  â”‚
â”‚        â€¢ åžå: æ¯åˆ†é’Ÿæœ€å¤š2ä¸ªè¯·æ±‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€ å¦‚æžœå—é™ â†’ è¿”å›žé˜Ÿåˆ—
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤6: åŠ è½½å’Œåˆ†å— (load_and_chunk_pdf)    â”‚
â”‚        â€¢ PDFReader.load_data()             â”‚
â”‚        â€¢ æå–æ‰€æœ‰æ–‡æœ¬                      â”‚
â”‚        â€¢ SentenceSplitter.split_text()     â”‚
â”‚          - chunk_size: 1000å­—ç¬¦            â”‚
â”‚          - overlap: 200å­—ç¬¦                â”‚
â”‚        â€¢ è¿”å›žchunksåˆ—è¡¨                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤7: ç”Ÿæˆå‘é‡åµŒå…¥ (embed_texts)          â”‚
â”‚        â€¢ è°ƒç”¨OpenAI API                    â”‚
â”‚        â€¢ æ¨¡åž‹: text-embedding-3-large      â”‚
â”‚        â€¢ è¿”å›ž List[List[float]] (3072ç»´)  â”‚
â”‚        (æ‰¹é‡å¤„ç†ï¼Œä¸€æ¬¡è°ƒç”¨)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤8: æž„é€ Pointå¯¹è±¡                       â”‚
â”‚        â€¢ ID: uuid5(source_id + index)      â”‚
â”‚        â€¢ Vector: 3072ç»´å‘é‡                 â”‚
â”‚        â€¢ Payload: {source, text}           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤9: æ‰¹é‡Upsertåˆ°Qdrant                  â”‚
â”‚        QdrantStorage.upsert(...)           â”‚
â”‚        â€¢ å¦‚æžœIDå­˜åœ¨ï¼Œæ›´æ–°                  â”‚
â”‚        â€¢ å¦‚æžœIDä¸å­˜åœ¨ï¼Œåˆ›å»º                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ (è¿”å›žç»“æžœ)

ç”¨æˆ·åé¦ˆå±‚ (Streamlitå‰ç«¯)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤10: æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯                       â”‚
â”‚         st.success("Triggered ingestion...")â”‚
â”‚         æ˜¾ç¤ºä¸Šä¼ äº†å¤šå°‘å—                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤11: å¯é€‰ä¸‹ä¸€æ­¥                         â”‚
â”‚         "You can upload another PDF..."    â”‚
â”‚         ç»§ç»­ä¸Šä¼ æˆ–å¼€å§‹æé—®                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

===== å®Œæ•´æ—¶é—´ç¤ºä¾‹ =====
ç”¨æˆ·é€‰æ‹©æ–‡ä»¶        2025-11-16 10:00:00
æ–‡ä»¶ä¸Šä¼ å®Œæˆ        2025-11-16 10:00:01
Inngestäº‹ä»¶å‘é€     2025-11-16 10:00:02
PDFè¯»å–å’Œåˆ†å—       2025-11-16 10:00:03  (1ç§’)
OpenAIå‘é‡ç”Ÿæˆ      2025-11-16 10:00:08  (5ç§’ï¼Œå–å†³äºŽæ–‡æ¡£å¤§å°)
Qdrantå­˜å‚¨å®Œæˆ      2025-11-16 10:00:09  (1ç§’)
ç”¨æˆ·çœ‹åˆ°æˆåŠŸ        2025-11-16 10:00:10

æ€»è€—æ—¶: 10ç§’
```

### æµç¨‹2: æé—®å’Œå›žç­”æµç¨‹

```
æ—¶é—´çº¿: ä»Žç”¨æˆ·è¾“å…¥é—®é¢˜åˆ°çœ‹åˆ°ç­”æ¡ˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç”¨æˆ·æ“ä½œå±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤1: ç”¨æˆ·è¾“å…¥é—®é¢˜               â”‚ â† "ä»€ä¹ˆæ˜¯ç›‘ç£å­¦ä¹ ?"
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤2: ç”¨æˆ·è®¾ç½®top_k (å¯é€‰)      â”‚ â† é»˜è®¤5ï¼ŒèŒƒå›´1-20
â”‚        è¿™æŽ§åˆ¶è¿”å›žå¤šå°‘ç›¸å…³æ®µè½     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤3: ç”¨æˆ·ç‚¹å‡»"Ask"æŒ‰é’®          â”‚
â”‚        éªŒè¯é—®é¢˜éžç©º               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤4: æ˜¾ç¤ºåŠ è½½åŠ¨ç”»               â”‚ â† with st.spinner(...)
â”‚        å‘é€Inngestäº‹ä»¶            â”‚ â† asyncio.run(...)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ (ç½‘ç»œè¯·æ±‚)

æœç´¢å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤5: InngestæŽ¥æ”¶ "rag/query_pdf_ai" äº‹ä»¶   â”‚
â”‚        (æŸ¥è¯¢æ²¡æœ‰é™æµï¼Œå¯ä»¥ä»»æ„å‘é€)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤6: é—®é¢˜å‘é‡åŒ– (embed_texts)              â”‚
â”‚        â€¢ è°ƒç”¨OpenAI API                      â”‚
â”‚        â€¢ å°†é—®é¢˜è½¬ä¸º3072ç»´å‘é‡                â”‚
â”‚        â€¢ è¿”å›žå•ä¸ªå‘é‡                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤7: å‘é‡æœç´¢ (QdrantStorage.search)       â”‚
â”‚        â€¢ åœ¨Qdrantä¸­æœç´¢                      â”‚
â”‚        â€¢ è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦ (0-2èŒƒå›´)            â”‚
â”‚        â€¢ è¿”å›žtop_kä¸ªæœ€ç›¸ä¼¼çš„Point            â”‚
â”‚        â€¢ æå–æ–‡æœ¬å’Œæ¥æº                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤8: æž„é€ æç¤ºè¯ (Prompt)                   â”‚
â”‚                                              â”‚
â”‚ ç³»ç»Ÿè§’è‰²:                                   â”‚
â”‚ "You answer questions using only the        â”‚
â”‚  provided context."                         â”‚
â”‚                                              â”‚
â”‚ ç”¨æˆ·æ¶ˆæ¯:                                   â”‚
â”‚ "Use the following context...                â”‚
â”‚  Context:                                   â”‚
â”‚  - æ®µè½1: xxx                               â”‚
â”‚  - æ®µè½2: yyy                               â”‚
â”‚  - æ®µè½3: zzz                               â”‚
â”‚                                              â”‚
â”‚  Question: {ç”¨æˆ·é—®é¢˜}                       â”‚
â”‚  Answer concisely..."                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
AIæŽ¨ç†å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤9: è°ƒç”¨GPT-4o-mini API                   â”‚
â”‚        ctx.step.ai.infer(...)                â”‚
â”‚                                              â”‚
â”‚        å‚æ•°:                                 â”‚
â”‚        â€¢ max_tokens: 1024                    â”‚
â”‚        â€¢ temperature: 0.2 (æ›´ç¡®å®š)           â”‚
â”‚        â€¢ messages: [system, user]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ (ç­‰å¾…AIå›žå¤ é€šå¸¸2-5ç§’)

ç»“æžœå¤„ç†å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤10: è§£æžAIå“åº”                           â”‚
â”‚         æå– answer å†…å®¹                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ (è¿”å›žç»“æžœ)

ç”¨æˆ·å±•ç¤ºå±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤11: æ˜¾ç¤ºç­”æ¡ˆ                             â”‚
â”‚         st.subheader("Answer")               â”‚
â”‚         st.write(answer)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤12: æ˜¾ç¤ºæ¥æºæ–‡ä»¶                         â”‚
â”‚         st.caption("Sources")                â”‚
â”‚         ä¸ºæ¯ä¸ªæ¥æºåˆ—å‡ºæ–‡ä»¶å                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤13: å¯é€‰ç»§ç»­æé—®                         â”‚
â”‚         ç”¨æˆ·å¯ä»¥ç»§ç»­è¾“å…¥æ–°é—®é¢˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

===== å®Œæ•´æ—¶é—´ç¤ºä¾‹ =====
ç”¨æˆ·è¾“å…¥é—®é¢˜         2025-11-16 10:30:00
ç‚¹å‡»AskæŒ‰é’®          2025-11-16 10:30:01
å‘é€Inngestäº‹ä»¶      2025-11-16 10:30:02
é—®é¢˜å‘é‡åŒ–           2025-11-16 10:30:02  (0.5ç§’)
Qdrantæœç´¢           2025-11-16 10:30:03  (0.5ç§’)
æž„é€ æç¤ºè¯           2025-11-16 10:30:03  (å³æ—¶)
GPT-4o-miniæŽ¨ç†      2025-11-16 10:30:08  (5ç§’)
è½®è¯¢ç­‰å¾…ç»“æžœ         2025-11-16 10:30:10  (è½®è¯¢é—´éš”0.5ç§’)
æ˜¾ç¤ºç­”æ¡ˆ             2025-11-16 10:30:11

æ€»è€—æ—¶: 11ç§’

===== æˆæœ¬ä¼°è®¡ =====
æ¯æ¬¡æŸ¥è¯¢è°ƒç”¨:
1. é—®é¢˜å‘é‡åŒ– (embed): æ–‡å­—tokenæ•° Ã— 0.00000002 USD
2. AIå›žç­” (gpt-4o-mini): è¾“å…¥token + è¾“å‡ºtoken Ã— è´¹çŽ‡

å‡è®¾:
- é—®é¢˜: 50å­— = ~30 tokens
- ä¸Šä¸‹æ–‡: 5æ®µ Ã— 100å­— = 500å­— = ~300 tokens
- ç­”æ¡ˆ: 200å­— = ~150 tokens

æˆæœ¬: çº¦$0.001-0.005 per query (å–å†³äºŽå†…å®¹)
```

---

## APIæŽ¥å£æ–‡æ¡£

### é‡è¦è¯´æ˜Ž

**è¿™ä¸ªåº”ç”¨æ²¡æœ‰ç›´æŽ¥çš„REST API**ã€‚æ‰€æœ‰é€šä¿¡éƒ½é€šè¿‡Inngestäº‹ä»¶ç³»ç»Ÿè¿›è¡Œã€‚

### Inngestäº‹ä»¶æŽ¥å£

#### äº‹ä»¶1: PDFä¸Šä¼ å’Œå¤„ç†

**äº‹ä»¶åç§°**: `rag/ingest_pdf`

```json
{
  "name": "rag/ingest_pdf",
  "data": {
    "pdf_path": "/home/user/uploads/document.pdf",
    "source_id": "document.pdf"
  }
}
```

**å‚æ•°è¯´æ˜Ž**:

| å‚æ•° | ç±»åž‹ | å¿…éœ€ | è¯´æ˜Ž |
|------|------|------|------|
| pdf_path | string | âœ“ | PDFæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ |
| source_id | string | âœ“ | å”¯ä¸€æ ‡è¯†ï¼Œé€šå¸¸ç”¨æ–‡ä»¶å |

**è¿”å›žå€¼**:

```json
{
  "ingested": 42
}
```

| å­—æ®µ | ç±»åž‹ | è¯´æ˜Ž |
|------|------|------|
| ingested | integer | æˆåŠŸå¤„ç†çš„æ–‡æœ¬å—æ•°é‡ |

**é™æµè§„åˆ™**:

- **é¢‘çŽ‡é™åˆ¶**: æ¯ä¸ª `source_id` æ¯4å°æ—¶æœ€å¤š1æ¬¡
- **åžåé™åˆ¶**: å…¨å±€æ¯åˆ†é’Ÿæœ€å¤š2ä¸ªè¯·æ±‚
- **è¶…é™å¤„ç†**: è¯·æ±‚ä¼šè¢«åŠ å…¥é˜Ÿåˆ—ï¼Œç­‰å¾…é™åˆ¶é‡ç½®

**è¶…æ—¶æ—¶é—´**: 60ç§’

**é‡è¯•ç­–ç•¥**: è‡ªåŠ¨é‡è¯•æœ€å¤š3æ¬¡ï¼Œä½¿ç”¨æŒ‡æ•°é€€é¿

**ç¤ºä¾‹ä»£ç **:

```python
# Pythonå®¢æˆ·ç«¯
import inngest

client = inngest.Inngest(app_id="rag_app", is_production=False)

# å‘é€ä¸Šä¼ äº‹ä»¶
event_id = await client.send(
    inngest.Event(
        name="rag/ingest_pdf",
        data={
            "pdf_path": "/home/user/uploads/machine_learning.pdf",
            "source_id": "machine_learning.pdf"
        }
    )
)
```

---

#### äº‹ä»¶2: æé—®å’Œå›žç­”

**äº‹ä»¶åç§°**: `rag/query_pdf_ai`

```json
{
  "name": "rag/query_pdf_ai",
  "data": {
    "question": "What is machine learning?",
    "top_k": 5
  }
}
```

**å‚æ•°è¯´æ˜Ž**:

| å‚æ•° | ç±»åž‹ | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜Ž |
|------|------|------|--------|------|
| question | string | âœ“ | - | ç”¨æˆ·çš„é—®é¢˜ |
| top_k | integer | âœ— | 5 | è¿”å›žå¤šå°‘ä¸ªç›¸å…³æ®µè½ (1-20) |

**è¿”å›žå€¼**:

```json
{
  "answer": "Machine learning is a subset of artificial intelligence...",
  "sources": ["machine_learning.pdf", "ai_guide.pdf"],
  "num_contexts": 5
}
```

| å­—æ®µ | ç±»åž‹ | è¯´æ˜Ž |
|------|------|------|
| answer | string | AIç”Ÿæˆçš„ç­”æ¡ˆ |
| sources | array | å›žç­”ä¸­å¼•ç”¨çš„PDFæ–‡ä»¶ååˆ—è¡¨ |
| num_contexts | integer | å®žé™…ä½¿ç”¨çš„ä¸Šä¸‹æ–‡æ®µè½æ•° |

**é™æµè§„åˆ™**:

- **é¢‘çŽ‡é™åˆ¶**: æ— é™åˆ¶
- **åžåé™åˆ¶**: æ— é™åˆ¶
- **å»ºè®®**: ç”Ÿäº§çŽ¯å¢ƒåº”æ·»åŠ é™æµé˜²æ­¢æ»¥ç”¨

**è¶…æ—¶æ—¶é—´**: 120ç§’

**é‡è¯•ç­–ç•¥**: è‡ªåŠ¨é‡è¯•æœ€å¤š3æ¬¡

**ç¤ºä¾‹ä»£ç **:

```python
# Pythonå®¢æˆ·ç«¯
import inngest

client = inngest.Inngest(app_id="rag_app", is_production=False)

# å‘é€æŸ¥è¯¢äº‹ä»¶
event_id = await client.send(
    inngest.Event(
        name="rag/query_pdf_ai",
        data={
            "question": "What is machine learning?",
            "top_k": 5
        }
    )
)

# è½®è¯¢èŽ·å–ç»“æžœ
import time
import requests

while True:
    response = requests.get(
        f"http://127.0.0.1:8288/v1/events/{event_id}/runs"
    )
    runs = response.json().get("data", [])

    if runs:
        run = runs[0]
        status = run.get("status")

        if status in ("Succeeded", "Completed"):
            return run.get("output")
        elif status in ("Failed", "Cancelled"):
            raise Exception(f"Run failed: {status}")

    time.sleep(0.5)  # æ¯0.5ç§’è½®è¯¢ä¸€æ¬¡
```

### FastAPIç«¯ç‚¹

Inngestè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹ç«¯ç‚¹ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰:

| æ–¹æ³• | è·¯å¾„ | ç”¨é€” |
|------|------|------|
| POST | `/api/inngest` | æŽ¥æ”¶äº‹ä»¶ |
| GET | `/api/inngest` | å¥åº·æ£€æŸ¥ |
| PUT | `/api/inngest` | å‡½æ•°æ³¨å†Œ |

**æ³¨æ„**: è¿™äº›ç«¯ç‚¹é€šå¸¸ä¸éœ€è¦ç›´æŽ¥è°ƒç”¨ï¼Œç”±Inngest SDKè‡ªåŠ¨ç®¡ç†ã€‚

---

## çŽ¯å¢ƒé…ç½®æŒ‡å—

### æ‰€éœ€çŽ¯å¢ƒå˜é‡

#### å¿…éœ€å˜é‡

```bash
# OpenAI APIå¯†é’¥
# ä»Ž https://platform.openai.com/api-keys èŽ·å–
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

**èŽ·å–æ­¥éª¤**:
1. è®¿é—® https://platform.openai.com/api-keys
2. ç‚¹å‡» "Create new secret key"
3. å¤åˆ¶å¯†é’¥åˆ°.envæ–‡ä»¶

#### å¯é€‰å˜é‡

```bash
# Inngestæœ¬åœ°å¼€å‘æœåŠ¡å™¨åœ°å€
# é»˜è®¤å€¼: http://127.0.0.1:8288/v1
INNGEST_API_BASE=http://127.0.0.1:8288/v1
```

### .envæ–‡ä»¶é…ç½®

**ä½ç½®**: é¡¹ç›®æ ¹ç›®å½•

**æ–‡ä»¶å†…å®¹**:

```bash
# .env ç¤ºä¾‹

# å¿…éœ€
OPENAI_API_KEY=sk-proj-your-api-key-here

# å¯é€‰ï¼ˆæœ‰é»˜è®¤å€¼ï¼‰
# INNGEST_API_BASE=http://127.0.0.1:8288/v1
```

**å®‰å…¨æç¤º**:
```bash
# è®¾ç½®æ­£ç¡®çš„æƒé™ï¼ˆä»…æ‰€æœ‰è€…å¯è¯»ï¼‰
chmod 600 .env

# ç¡®ä¿.envåœ¨.gitignoreä¸­ï¼ˆä¸ä¸Šä¼ åˆ°Gitï¼‰
echo ".env" >> .gitignore

# éªŒè¯.envç¡®å®žè¢«å¿½ç•¥
git check-ignore .env
```

### çŽ¯å¢ƒéªŒè¯

```bash
# éªŒè¯Pythonç‰ˆæœ¬
python --version
# åº”è¯¥è¾“å‡º: Python 3.13.x æˆ–æ›´é«˜

# éªŒè¯ä¾èµ–å®‰è£…
python -c "import fastapi; import streamlit; import inngest"
# å¦‚æžœæ²¡æœ‰é”™è¯¯è¯´æ˜Žä¾èµ–å·²å®‰è£…

# éªŒè¯OpenAI APIå¯†é’¥
python -c "import os; from dotenv import load_dotenv; load_dotenv(); print('OPENAI_API_KEY:', 'OK' if os.getenv('OPENAI_API_KEY') else 'MISSING')"
```

---

## æœ¬åœ°å¼€å‘æŒ‡å—

### å‰ç½®æ¡ä»¶

**ç³»ç»Ÿè¦æ±‚**:

| è¦æ±‚ | ç‰ˆæœ¬ | å¤‡æ³¨ |
|------|------|------|
| Python | >= 3.13 | æŽ¨è3.13+ |
| Node.js | >= 18 | ç”¨äºŽInngest CLI |
| ç£ç›˜ç©ºé—´ | >= 5GB | ç”¨äºŽä¾èµ–å’Œæ•°æ®åº“ |
| å†…å­˜ | >= 4GB | è¿è¡Œæ‰€æœ‰æœåŠ¡ |

**æ“ä½œç³»ç»Ÿæ”¯æŒ**:
- âœ… Linux (Ubuntu, Debian, CentOS)
- âœ… macOS (Intel and Apple Silicon)
- âœ… Windows (with WSL2 recommended)

### çŽ¯å¢ƒæ­å»ºæ­¥éª¤

#### æ­¥éª¤1: å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/YOUR_REPO/ProductionGradeRAGPythonApp.git
cd ProductionGradeRAGPythonApp
```

#### æ­¥éª¤2: åˆ›å»ºPythonè™šæ‹ŸçŽ¯å¢ƒ

```bash
# æ–¹æ¡ˆA: ä½¿ç”¨venv (å†…ç½®)
python -m venv venv
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\Scripts\activate  # Windows

# æ–¹æ¡ˆB: ä½¿ç”¨uv (æŽ¨èï¼Œæ›´å¿«)
pip install uv
uv venv
source .venv/bin/activate  # Linux/macOS
```

#### æ­¥éª¤3: å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨uv (æŽ¨è)
uv pip install

# æˆ–ä½¿ç”¨pip
pip install -r requirements.txt

# æˆ–ç›´æŽ¥ä»Žpyproject.toml
pip install -e .
```

#### æ­¥éª¤4: é…ç½®çŽ¯å¢ƒå˜é‡

```bash
# åˆ›å»º.envæ–‡ä»¶
cp .env.example .env  # å¦‚æžœæœ‰ç¤ºä¾‹æ–‡ä»¶

# æˆ–æ‰‹åŠ¨åˆ›å»º
cat > .env << EOF
OPENAI_API_KEY=sk-proj-your-key-here
INNGEST_API_BASE=http://127.0.0.1:8288/v1
EOF

# éªŒè¯
cat .env
```

#### æ­¥éª¤5: å®‰è£…Node.jsä¾èµ–ï¼ˆç”¨äºŽInngest CLIï¼‰

```bash
# å®‰è£…Node.js
# macOS
brew install node

# Linux (Ubuntu/Debian)
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# Windows
# ä»Ž https://nodejs.org ä¸‹è½½å®‰è£…å™¨
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

**éœ€è¦3ä¸ªç‹¬ç«‹çš„ç»ˆç«¯çª—å£**:

#### ç»ˆç«¯1: å¯åŠ¨Inngestå¼€å‘æœåŠ¡å™¨

```bash
# å®‰è£…Inngest CLI (ä»…éœ€ä¸€æ¬¡)
npm install -g inngest-cli

# å¯åŠ¨Inngestå¼€å‘æœåŠ¡å™¨
npx inngest-cli@latest dev

# è¾“å‡ºåº”è¯¥æ˜¾ç¤º:
# âœ“ Event stream
# âœ“ API
# âœ“ UI
#
# Inngest Dev Server is ready
# http://127.0.0.1:8288
```

**è®¿é—®Inngest UI**: http://127.0.0.1:8288
- å®žæ—¶æŸ¥çœ‹å‡½æ•°æ‰§è¡Œ
- æ£€æŸ¥æ—¥å¿—å’Œé”™è¯¯
- æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡

#### ç»ˆç«¯2: å¯åŠ¨FastAPIåŽç«¯

```bash
# ç¡®ä¿åœ¨è™šæ‹ŸçŽ¯å¢ƒä¸­
source venv/bin/activate  # æˆ–ä½ çš„è™šæ‹ŸçŽ¯å¢ƒ

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (å¸¦çƒ­é‡è½½)
uvicorn main:app --reload --host 127.0.0.1 --port 8000

# è¾“å‡ºåº”è¯¥æ˜¾ç¤º:
# Uvicorn running on http://127.0.0.1:8000
# Press CTRL+C to quit
```

**APIæ–‡æ¡£**: http://127.0.0.1:8000/docs (Swagger UI)

**è®¿é—®è¿™ä¸ªåœ°å€å¯ä»¥çœ‹åˆ°APIäº¤äº’æ–‡æ¡£**

#### ç»ˆç«¯3: å¯åŠ¨Streamlitå‰ç«¯

```bash
# ç¡®ä¿åœ¨è™šæ‹ŸçŽ¯å¢ƒä¸­
source venv/bin/activate

# å¯åŠ¨StreamlitæœåŠ¡å™¨
streamlit run streamlit_app.py

# è¾“å‡ºåº”è¯¥æ˜¾ç¤º:
# You can now view your Streamlit app in your browser.
# Local URL: http://localhost:8501
```

**Streamlitåº”ç”¨**: http://localhost:8501

### å®Œæ•´å¯åŠ¨è„šæœ¬

åˆ›å»º `start_dev.sh`:

```bash
#!/bin/bash

# å¼€å‘çŽ¯å¢ƒä¸€é”®å¯åŠ¨è„šæœ¬

echo "=== RAGåº”ç”¨å¼€å‘çŽ¯å¢ƒå¯åŠ¨è„šæœ¬ ==="
echo ""

# æ£€æŸ¥ä¾èµ–
echo "æ£€æŸ¥å‰ç½®æ¡ä»¶..."
python --version || (echo "Pythonæœªå®‰è£…"; exit 1)
node --version || (echo "Node.jsæœªå®‰è£…"; exit 1)

# æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ
echo "æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ..."
source venv/bin/activate || python -m venv venv && source venv/bin/activate

# å®‰è£…ä¾èµ–
echo "å®‰è£…ä¾èµ–..."
uv pip install > /dev/null 2>&1 || pip install -q -r requirements.txt

# åˆ›å»ºuploadsç›®å½•
mkdir -p uploads
mkdir -p qdrant_storage

echo ""
echo "âœ… çŽ¯å¢ƒå°±ç»ªï¼"
echo ""
echo "è¯·åœ¨3ä¸ªç‹¬ç«‹çš„ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š"
echo ""
echo "1ï¸âƒ£ ç»ˆç«¯1 (Inngest):"
echo "   npx inngest-cli@latest dev"
echo ""
echo "2ï¸âƒ£ ç»ˆç«¯2 (åŽç«¯):"
echo "   uvicorn main:app --reload"
echo ""
echo "3ï¸âƒ£ ç»ˆç«¯3 (å‰ç«¯):"
echo "   streamlit run streamlit_app.py"
echo ""
echo "åº”ç”¨åœ°å€:"
echo "  - å‰ç«¯: http://localhost:8501"
echo "  - åŽç«¯: http://127.0.0.1:8000"
echo "  - Inngest UI: http://127.0.0.1:8288"
```

è¿è¡Œ:
```bash
chmod +x start_dev.sh
./start_dev.sh
```

### å¼€å‘æ—¶å¸¸è§ä»»åŠ¡

#### ä»»åŠ¡1: æŸ¥çœ‹æ—¥å¿—

```bash
# Inngestæ—¥å¿—
# åœ¨Inngest UIä¸­æŸ¥çœ‹: http://127.0.0.1:8288

# FastAPIæ—¥å¿—
# è¾“å‡ºåœ¨ç»ˆç«¯2ä¸­

# Streamlitæ—¥å¿—
# è¾“å‡ºåœ¨ç»ˆç«¯3ä¸­
```

#### ä»»åŠ¡2: è°ƒè¯•ä»£ç 

```python
# main.py ä¸­æ·»åŠ è°ƒè¯•ä»£ç 
import logging
logging.basicConfig(level=logging.DEBUG)

# æ·»åŠ æ—¥å¿—
logger = logging.getLogger(__name__)
logger.debug(f"Processing PDF: {pdf_path}")

# è¿è¡Œæ—¶çœ‹åˆ°DEBUGè¾“å‡º
```

#### ä»»åŠ¡3: æµ‹è¯•å•ä¸ªå‡½æ•°

```python
# åˆ›å»º test_functions.py

import asyncio
from main import rag_ingest_pdf
from custom_types import RAGChunkAndSrc

async def test_ingest():
    # æ¨¡æ‹ŸInngest Context
    class MockContext:
        class event:
            data = {
                "pdf_path": "path/to/file.pdf",
                "source_id": "file.pdf"
            }

        class step:
            async def run(self, name, func, *args):
                return await func(*args)

    ctx = MockContext()
    result = await rag_ingest_pdf(ctx)
    print(result)

# è¿è¡Œ
asyncio.run(test_ingest())
```

#### ä»»åŠ¡4: é‡ç½®æ•°æ®åº“

```bash
# åˆ é™¤æ‰€æœ‰Qdrantæ•°æ®
rm -rf qdrant_storage/

# åˆ é™¤æ‰€æœ‰ä¸Šä¼ çš„PDF
rm -rf uploads/*

# ä¸‹æ¬¡å¯åŠ¨æ—¶ä¼šé‡æ–°åˆ›å»ºé›†åˆ
```

#### ä»»åŠ¡5: æŸ¥çœ‹ä¾èµ–æ ‘

```bash
# æŸ¥çœ‹æ‰€æœ‰å·²å®‰è£…çš„åŒ…
pip list

# æŸ¥çœ‹ä¾èµ–æ ‘ï¼ˆéœ€è¦å…ˆå®‰è£…ï¼‰
pip install pipdeptree
pipdeptree
```

---

## éƒ¨ç½²æŒ‡å—

### éƒ¨ç½²å‰æ¸…å•

- [ ] æ›´æ–°æ‰€æœ‰ä¾èµ–åˆ°æœ€æ–°ç‰ˆæœ¬
- [ ] è¿è¡Œæ‰€æœ‰æµ‹è¯•
- [ ] è¿›è¡Œä»£ç å®¡æŸ¥
- [ ] æ£€æŸ¥æ—¥å¿—è¾“å‡º
- [ ] éªŒè¯é”™è¯¯å¤„ç†
- [ ] è¿›è¡Œå®‰å…¨å®¡è®¡
- [ ] å‡†å¤‡æ•°æ®å¤‡ä»½ç­–ç•¥
- [ ] å‡†å¤‡å›žæ»šæ–¹æ¡ˆ

### æœ¬åœ°éƒ¨ç½²ï¼ˆå•æœºï¼‰

#### Dockeræ–¹å¼ï¼ˆæŽ¨èï¼‰

**Dockerfile**:

```dockerfile
# Dockerfile
FROM python:3.13-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    libpq-dev \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY pyproject.toml uv.lock ./

# å®‰è£…Pythonä¾èµ–
RUN pip install uv && uv pip install --system

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000 8501

# åˆ›å»ºå¿…è¦ç›®å½•
RUN mkdir -p uploads qdrant_storage

# å¯åŠ¨è„šæœ¬
CMD ["bash", "-c", "uvicorn main:app --host 0.0.0.0 --port 8000 & streamlit run streamlit_app.py --server.port 8501 --server.address 0.0.0.0"]
```

**Docker Compose**:

```yaml
# docker-compose.yml
version: '3.8'

services:
  # Qdrantå‘é‡æ•°æ®åº“
  qdrant:
    image: qdrant/qdrant:latest
    container_name: qdrant
    ports:
      - "6333:6333"
    volumes:
      - qdrant_storage:/qdrant/storage
    environment:
      - QDRANT_API_KEY=${QDRANT_API_KEY:-}
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:6333/health"]
      interval: 30s
      timeout: 10s
      retries: 3

  # FastAPIåŽç«¯ + Streamlitå‰ç«¯
  app:
    build: .
    container_name: rag-app
    ports:
      - "8000:8000"
      - "8501:8501"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - INNGEST_API_BASE=${INNGEST_API_BASE:-http://inngest:8288/v1}
    volumes:
      - ./uploads:/app/uploads
      - ./qdrant_storage:/app/qdrant_storage
    depends_on:
      qdrant:
        condition: service_healthy
    restart: unless-stopped

  # Inngestäº‹ä»¶å¤„ç†ï¼ˆå¯é€‰ï¼Œæœ¬åœ°å¼€å‘ç”¨ï¼‰
  inngest:
    image: inngest/inngest:latest
    container_name: inngest
    ports:
      - "8288:8288"
    environment:
      - INNGEST_DEV=1
    restart: unless-stopped

volumes:
  qdrant_storage:
    driver: local
```

**å¯åŠ¨æ–¹å¼**:

```bash
# å¤åˆ¶.envæ–‡ä»¶
cp .env.example .env
# ç¼–è¾‘.envï¼Œå¡«å…¥OPENAI_API_KEY

# æž„å»ºé•œåƒï¼ˆä»…éœ€ä¸€æ¬¡ï¼‰
docker-compose build

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down

# ä¿ç•™æ•°æ®åœæ­¢
docker-compose stop

# åˆ é™¤æ‰€æœ‰æ•°æ®å’Œå®¹å™¨
docker-compose down -v
```

**è®¿é—®åº”ç”¨**:
- å‰ç«¯: http://localhost:8501
- åŽç«¯API: http://localhost:8000
- Qdrant: http://localhost:6333
- Inngest: http://localhost:8288

### äº‘å¹³å°éƒ¨ç½²

#### Railway.app éƒ¨ç½²ç¤ºä¾‹

```yaml
# railway.json
{
  "name": "RAG Application",
  "description": "Production-ready RAG Python Application",
  "buildCommand": "pip install -r requirements.txt",
  "startCommand": "uvicorn main:app --host 0.0.0.0 --port $PORT"
}
```

**éƒ¨ç½²æ­¥éª¤**:

1. åˆ›å»ºRailwayè´¦æˆ· (https://railway.app)
2. è¿žæŽ¥GitHubä»“åº“
3. è®¾ç½®çŽ¯å¢ƒå˜é‡:
   - `OPENAI_API_KEY`: ä½ çš„APIå¯†é’¥
   - `INNGEST_API_BASE`: InngestæœåŠ¡å™¨åœ°å€
4. éƒ¨ç½²

#### Render.com éƒ¨ç½²ç¤ºä¾‹

1. åˆ›å»ºRenderè´¦æˆ·
2. New â†’ Web Service
3. è¿žæŽ¥GitHubä»“åº“
4. è®¾ç½®:
   - Build Command: `pip install -r requirements.txt`
   - Start Command: `uvicorn main:app --host 0.0.0.0 --port $PORT`
5. è®¾ç½®çŽ¯å¢ƒå˜é‡
6. éƒ¨ç½²

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### ç”Ÿäº§çŽ¯å¢ƒé…ç½®

```bash
# Uvicornä¼˜åŒ–
uvicorn main:app \
  --host 0.0.0.0 \
  --port 8000 \
  --workers 4 \              # å¤šä¸ªå·¥ä½œè¿›ç¨‹
  --worker-class uvicorn.workers.UvicornWorker \
  --loop uvloop \             # æ›´å¿«çš„äº‹ä»¶å¾ªçŽ¯
  --http httptools            # CåŠ é€ŸHTTPè§£æž
```

#### æ•°æ®åº“ä¼˜åŒ–

```python
# Qdrantè¿žæŽ¥æ± ä¼˜åŒ–
class QdrantStorage:
    def __init__(self, url="http://localhost:6333"):
        self.client = QdrantClient(
            url=url,
            timeout=30,
            prefer_grpc=True,  # ä½¿ç”¨gRPCæ›´å¿«
            grpc_port=6334     # gRPCç«¯å£
        )
```

---

## å¸¸è§é—®é¢˜FAQ

### Q1: "ModuleNotFoundError: No module named 'openai'"

**é—®é¢˜**: è¿è¡Œæ—¶å‡ºçŽ°å¯¼å…¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡æ–°å®‰è£…ä¾èµ–
pip install --upgrade openai

# æˆ–æ£€æŸ¥è™šæ‹ŸçŽ¯å¢ƒ
which python  # åº”è¯¥æŒ‡å‘è™šæ‹ŸçŽ¯å¢ƒ
source venv/bin/activate  # é‡æ–°æ¿€æ´»
```

---

### Q2: "OpenAI API key not found"

**é—®é¢˜**: åº”ç”¨æ‰¾ä¸åˆ°APIå¯†é’¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥.envæ–‡ä»¶å­˜åœ¨
ls -la .env

# æ£€æŸ¥å¯†é’¥æ ¼å¼
cat .env | grep OPENAI

# åº”è¯¥è¾“å‡º: OPENAI_API_KEY=sk-proj-xxxx

# éªŒè¯å¯†é’¥æœ‰æ•ˆ
python -c "
import os
from dotenv import load_dotenv
load_dotenv()
key = os.getenv('OPENAI_API_KEY')
if key and key.startswith('sk-'):
    print('âœ“ å¯†é’¥æ ¼å¼æ­£ç¡®')
else:
    print('âœ— å¯†é’¥æ ¼å¼é”™è¯¯æˆ–æœªè®¾ç½®')
"
```

---

### Q3: "ConnectionError: Failed to connect to Qdrant"

**é—®é¢˜**: æ— æ³•è¿žæŽ¥å‘é‡æ•°æ®åº“

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥Qdrantæ˜¯å¦è¿è¡Œ
curl http://localhost:6333/health

# å¦‚æžœå¤±è´¥ï¼Œå¯åŠ¨Qdrant
docker run -p 6333:6333 qdrant/qdrant

# æˆ–ä½¿ç”¨Docker Compose
docker-compose up qdrant
```

---

### Q4: "Inngest connection failed"

**é—®é¢˜**: æ— æ³•è¿žæŽ¥Inngestäº‹ä»¶å¼•æ“Ž

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¯åŠ¨Inngestå¼€å‘æœåŠ¡å™¨
npx inngest-cli@latest dev

# éªŒè¯è¿žæŽ¥
curl http://127.0.0.1:8288

# æ£€æŸ¥.envä¸­çš„INNGEST_API_BASE
# åº”è¯¥æ˜¯: http://127.0.0.1:8288/v1
```

---

### Q5: "PDFä¸Šä¼ åŽæ²¡æœ‰ååº”"

**é—®é¢˜**: ä¸Šä¼ PDFåŽï¼Œåº”ç”¨æ²¡æœ‰å¤„ç†

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥åŽç«¯æ—¥å¿— (ç»ˆç«¯2)
# åº”è¯¥çœ‹åˆ° "load-and-chunk" å’Œ "embed-and-upsert" æ­¥éª¤

# 2. æ£€æŸ¥Inngest UI
# http://127.0.0.1:8288 æŸ¥çœ‹å‡½æ•°æ‰§è¡Œ

# 3. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¿å­˜
ls -la uploads/

# 4. æ£€æŸ¥OpenAI APIè°ƒç”¨
# åœ¨åŽç«¯æ—¥å¿—ä¸­åº”è¯¥çœ‹åˆ°APIè¯·æ±‚

# 5. éªŒè¯APIé…é¢
# è®¿é—® https://platform.openai.com/account/usage
```

---

### Q6: "Timeout waiting for run output"

**é—®é¢˜**: æé—®è¶…æ—¶ï¼Œé•¿æ—¶é—´æ— æ³•èŽ·å¾—ç­”æ¡ˆ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥åŽç«¯æ˜¯å¦å“åº”
curl http://127.0.0.1:8000/docs

# 2. æ£€æŸ¥OpenAI APIé€Ÿåº¦
# æŸäº›æƒ…å†µä¸‹APIå“åº”æ…¢
# ç­‰å¾…å‡ ç§’å†è¯•

# 3. å¢žåŠ è¶…æ—¶æ—¶é—´ (streamlit_app.py)
# ä¿®æ”¹ wait_for_run_output çš„ timeout_s å‚æ•°
def wait_for_run_output(event_id: str, timeout_s: float = 180.0):
    # æ”¹ä¸º180ç§’
    ...

# 4. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
ping api.openai.com
```

---

### Q7: "Too many requests" é”™è¯¯

**é—®é¢˜**: APIè°ƒç”¨è¶…è¿‡é™æµé˜ˆå€¼

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¯¹äºŽPDFä¸Šä¼ :
# å½“å‰é™åˆ¶: æ¯ä¸ªæ–‡ä»¶æ¯4å°æ—¶æœ€å¤š1æ¬¡
# è§£å†³æ–¹æ¡ˆ: æ”¹å˜æ–‡ä»¶åæˆ–ç­‰å¾…4å°æ—¶

# å¯¹äºŽé—®é¢˜æŸ¥è¯¢:
# å½“å‰æ²¡æœ‰é™åˆ¶
# ä½†å»ºè®®ç”Ÿäº§çŽ¯å¢ƒæ·»åŠ 

# æ£€æŸ¥é™æµè§„åˆ™ (main.py)
rate_limit=inngest.RateLimit(
    limit=1,
    period=datetime.timedelta(hours=4),
    key="event.data.source_id",
)
```

---

### Q8: "å‘é‡æ•°æ®åº“å˜å¾—å¾ˆå¤§"

**é—®é¢˜**: qdrant_storage ç›®å½•å ç”¨å¤§é‡ç£ç›˜ç©ºé—´

**åŽŸå› **:
- ä¸Šä¼ äº†å¤ªå¤šæ–‡æ¡£
- åŒä¸€æ–‡æ¡£å¤šæ¬¡ä¸Šä¼ 

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…ç©ºæ•´ä¸ªæ•°æ®åº“
rm -rf qdrant_storage/
# ä¸‹æ¬¡å¯åŠ¨æ—¶é‡æ–°åˆ›å»º

# æˆ–åªåˆ é™¤ç‰¹å®šé›†åˆ
# (éœ€è¦è‡ªå·±å®žçŽ°åˆ é™¤é€»è¾‘)

# æŸ¥çœ‹æ•°æ®åº“å¤§å°
du -sh qdrant_storage/

# æŸ¥çœ‹å•ä½
# K = KB, M = MB, G = GB
```

---

### Q9: "GPU/åŠ é€Ÿç¡¬ä»¶ç›¸å…³é”™è¯¯"

**é—®é¢˜**: CUDAã€MPSæˆ–å…¶ä»–åŠ é€Ÿç›¸å…³é”™è¯¯

**è¯´æ˜Ž**: æœ¬åº”ç”¨ä¸ä½¿ç”¨GPU
- æ‰€æœ‰è®¡ç®—åœ¨CPUä¸Šè¿›è¡Œ
- OpenAI APIè¿œç¨‹è°ƒç”¨ï¼Œæ— éœ€æœ¬åœ°GPU
- å‘é‡æœç´¢åœ¨Qdrantä¸Šï¼Œä¹Ÿä¸éœ€è¦GPU

**è§£å†³æ–¹æ¡ˆ**: é€šå¸¸å¯ä»¥å®‰å…¨å¿½ç•¥è¿™äº›è­¦å‘Š

---

### Q10: "ç”Ÿäº§çŽ¯å¢ƒéƒ¨ç½²æ³¨æ„äº‹é¡¹"

**å¸¸è§é—®é¢˜**: æœ¬åœ°å·¥ä½œä½†éƒ¨ç½²åŽå¤±è´¥

**æ£€æŸ¥æ¸…å•**:

```
â–¡ æ˜¯å¦è®¾ç½®äº†æ‰€æœ‰çŽ¯å¢ƒå˜é‡
â–¡ OPENAI_API_KEY æ˜¯å¦æ­£ç¡®
â–¡ INNGEST_API_BASE æ˜¯å¦æŒ‡å‘æ­£ç¡®çš„æœåŠ¡å™¨
â–¡ æ•°æ®åº“è¿žæŽ¥æ˜¯å¦ç•…é€š
â–¡ æ–‡ä»¶ç³»ç»Ÿæƒé™æ˜¯å¦æ­£ç¡®
â–¡ é˜²ç«å¢™æ˜¯å¦å¼€æ”¾å¿…è¦ç«¯å£
â–¡ SSL/HTTPSæ˜¯å¦æ­£ç¡®é…ç½®
â–¡ æ—¥å¿—è¾“å‡ºæ˜¯å¦å¯è¯»
â–¡ å¤‡ä»½ç­–ç•¥æ˜¯å¦å·²å®žæ–½
â–¡ ç›‘æŽ§å‘Šè­¦æ˜¯å¦å·²é…ç½®
```

**å¸¸è§éƒ¨ç½²é”™è¯¯**:

| é”™è¯¯ | åŽŸå›  | è§£å†³ |
|------|------|------|
| 502 Bad Gateway | åŽç«¯æœªè¿è¡Œ | æ£€æŸ¥è¿›ç¨‹ |
| è¿žæŽ¥è¶…æ—¶ | é˜²ç«å¢™é˜»æ­¢ | é…ç½®å®‰å…¨ç»„ |
| æ–‡ä»¶æƒé™é”™è¯¯ | ç›®å½•æƒé™ä¸è¶³ | chmod 755 |
| æ•°æ®ä¸¢å¤± | æœªæŒ‚è½½æ•°æ®å· | é…ç½®æŒä¹…åŒ– |

---

## æœ¯è¯­å¯¹ç…§è¡¨

### è‹±æ–‡æœ¯è¯­ â†’ ä¸­æ–‡å«ä¹‰

| è‹±æ–‡ | ä¸­æ–‡ | è§£é‡Š |
|------|------|------|
| RAG | æ£€ç´¢å¢žå¼ºç”Ÿæˆ | ä¸€ç§AIæŠ€æœ¯ï¼Œå…ˆæœç´¢ç›¸å…³ä¿¡æ¯ï¼Œå†ç”¨AIç”Ÿæˆç­”æ¡ˆ |
| Vector Database | å‘é‡æ•°æ®åº“ | ä¸“é—¨å­˜å‚¨æ•°æ®çš„"å«ä¹‰"è€Œä¸æ˜¯æ•°æ®æœ¬èº«çš„æ•°æ®åº“ |
| Embedding | åµŒå…¥/å‘é‡åŒ– | å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—å‘é‡çš„è¿‡ç¨‹ |
| Semantic Search | è¯­ä¹‰æœç´¢ | æ ¹æ®å«ä¹‰è€Œä¸æ˜¯å…³é”®è¯æŸ¥æ‰¾å†…å®¹ |
| Chunk | å—/æ®µè½ | é•¿æ–‡æœ¬è¢«åˆ†å‰²æˆçš„å°ç‰‡æ®µ |
| Context | ä¸Šä¸‹æ–‡/èƒŒæ™¯ | ä¸ºAIæä¾›çš„ç›¸å…³ä¿¡æ¯ |
| Prompt | æç¤ºè¯ | ç»™AIçš„æŒ‡ä»¤å’ŒèƒŒæ™¯ä¿¡æ¯ |
| Token | ä»¤ç‰Œ | AIè®¡ç®—çš„æœ€å°å•ä½ï¼Œé€šå¸¸æ˜¯å‡ ä¸ªå­—ç¬¦ |
| Rate Limiting | é™æµ | é™åˆ¶è¯·æ±‚é¢‘çŽ‡ä»¥é˜²æ­¢æ»¥ç”¨ |
| Throttling | èŠ‚æµ | é™åˆ¶åŒæ—¶å¤„ç†çš„ä»»åŠ¡æ•°é‡ |
| Qdrant | Qdrant | å‘é‡æ•°æ®åº“çš„åç§°ï¼ˆå“ç‰Œï¼‰ |
| Inngest | Inngest | äº‹ä»¶å¤„ç†å¼•æ“Žçš„åç§°ï¼ˆå“ç‰Œï¼‰ |
| FastAPI | FastAPI | Webæ¡†æž¶çš„åç§°ï¼ˆå“ç‰Œï¼‰ |
| Streamlit | Streamlit | Web UIæ¡†æž¶çš„åç§°ï¼ˆå“ç‰Œï¼‰ |
| Async | å¼‚æ­¥ | éžé˜»å¡žå¼æ‰§è¡Œï¼Œå¯åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ |
| Callback | å›žè°ƒ | ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ ç»™å¦ä¸€ä¸ªå‡½æ•° |
| Payload | è´Ÿè½½/æ•°æ®åŒ… | è¯·æ±‚æˆ–å“åº”ä¸­çš„å®žé™…æ•°æ® |
| UUID | é€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ | ç”¨æ¥å”¯ä¸€æ ‡è¯†å¯¹è±¡çš„128ä½æ•°å­— |

---

## é™„å½•ï¼šå¿«é€Ÿå‚è€ƒ

### å¿«é€Ÿå¯åŠ¨

```bash
# 1ï¸âƒ£ çŽ¯å¢ƒå‡†å¤‡
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 2ï¸âƒ£ é…ç½®
cat > .env << EOF
OPENAI_API_KEY=sk-your-key
EOF

# 3ï¸âƒ£ å¯åŠ¨ï¼ˆéœ€è¦3ä¸ªç»ˆç«¯ï¼‰
# ç»ˆç«¯1
npx inngest-cli@latest dev

# ç»ˆç«¯2
uvicorn main:app --reload

# ç»ˆç«¯3
streamlit run streamlit_app.py

# 4ï¸âƒ£ è®¿é—®
# å‰ç«¯: http://localhost:8501
# åŽç«¯API: http://127.0.0.1:8000/docs
# Inngest UI: http://127.0.0.1:8288
```

### å…³é”®æ–‡ä»¶é€ŸæŸ¥

| æ–‡ä»¶ | ä½ç½® | åŠŸèƒ½ |
|------|------|------|
| åŽç«¯ä¸»æ–‡ä»¶ | `/main.py` | FastAPIåº”ç”¨ï¼Œå®šä¹‰Inngestå‡½æ•° |
| å‰ç«¯é¡µé¢ | `/streamlit_app.py` | Webç•Œé¢ï¼Œç”¨æˆ·äº¤äº’ |
| æ•°æ®åº“æ“ä½œ | `/vector_db.py` | Qdrantè¿žæŽ¥å’ŒæŸ¥è¯¢ |
| æ•°æ®å¤„ç† | `/data_loader.py` | PDFè¯»å–ï¼Œå‘é‡ç”Ÿæˆ |
| æ•°æ®æ¨¡åž‹ | `/custom_types.py` | Pydanticæ¨¡åž‹å®šä¹‰ |
| é…ç½®æ–‡ä»¶ | `/pyproject.toml` | é¡¹ç›®å…ƒæ•°æ®å’Œä¾èµ– |
| çŽ¯å¢ƒå˜é‡ | `/.env` | APIå¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯ |

### å¸¸ç”¨å‘½ä»¤

```bash
# å¼€å‘
python -m pytest                    # è¿è¡Œæµ‹è¯•
black main.py                       # ä»£ç æ ¼å¼åŒ–
pylint main.py                      # ä»£ç æ£€æŸ¥
uvicorn main:app --reload          # å¼€å‘æœåŠ¡å™¨

# ç”Ÿäº§
docker-compose up -d                # å¯åŠ¨å®¹å™¨
docker-compose logs -f              # æŸ¥çœ‹æ—¥å¿—
docker-compose down                 # åœæ­¢å®¹å™¨

# æ•°æ®åº“
curl http://localhost:6333/health   # æ£€æŸ¥Qdrant
curl http://localhost:6333/collections # æŸ¥çœ‹é›†åˆ

# è°ƒè¯•
python -c "from dotenv import load_dotenv; load_dotenv()"  # æµ‹è¯•.env
python -c "from openai import OpenAI; OpenAI()"  # æµ‹è¯•API
```

---

## æ€»ç»“

è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨çŽ°ä»£PythonæŠ€æœ¯æ ˆæž„å»ºç”Ÿäº§çº§AIåº”ç”¨ï¼š

âœ… **å‰ç«¯**: Streamlit æä¾›ç®€æ´çš„Webç•Œé¢
âœ… **åŽç«¯**: FastAPI æä¾›é«˜æ€§èƒ½å¼‚æ­¥æœåŠ¡å™¨
âœ… **äº‹ä»¶**: Inngest æä¾›å¯é çš„å¼‚æ­¥ä»»åŠ¡å¤„ç†
âœ… **æ•°æ®åº“**: Qdrant æä¾›å‘é‡æœç´¢èƒ½åŠ›
âœ… **AI**: OpenAI æä¾›å¼ºå¤§çš„è¯­è¨€æ¨¡åž‹

**ä¸‹ä¸€æ­¥**:
1. è¿è¡Œæœ¬åœ°å¼€å‘çŽ¯å¢ƒï¼ˆå‚è€ƒæœ¬åœ°å¼€å‘æŒ‡å—ï¼‰
2. ä¸Šä¼ PDFå¹¶æµ‹è¯•æé—®åŠŸèƒ½
3. æ ¹æ®éœ€è¦è°ƒæ•´å‚æ•°å’Œé…ç½®
4. éƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒ

**èŽ·å–å¸®åŠ©**:
- æŸ¥çœ‹åˆ†æžæ–‡æ¡£: `project-mastery/analysis/`
- æŸ¥çœ‹æºä»£ç æ³¨é‡Š
- æŸ¥çœ‹Inngest UIå®žæ—¶æ—¥å¿—
- æŸ¥çœ‹OpenAI APIæ–‡æ¡£

---

**æ–‡æ¡£å®Œæˆ** âœ…
**æœ€åŽæ›´æ–°**: 2025-11-16
**ç‰ˆæœ¬**: 1.0

